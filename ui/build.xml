<!-- 

	All content on this website (including text, images, source
	code and any other original works), unless otherwise noted,
	is licensed under a Creative Commons License.

	http://creativecommons.org/licenses/by-nc-sa/2.5/

	Copyright (C) Open-Xchange Inc., 2011
	Mail: info@open-xchange.com

	@author Matthias Biggeleben <matthias.biggeleben@open-xchange.com>

 -->

<project name="ui" default="all" basedir=".">

	<!-- Adjust that to your document root, e.g. /var/www/ox7 -->
	<property name="build" value="${basedir}/build"/>
	<property file="./build.properties"/>
	
    <target name="prepare">
    	
    	<mkdir dir="${build}"/>
    	
    	<propertyfile file="./build.properties">
    		<entry key="version.build" type="int" operation="+" value="1" pattern="00000"/>
    	</propertyfile>

    	<property name="version" value="7.0.0.${version.build}" />
    	
    	<echo message= "Build ${version}"/>
    	
    </target>
	
	<target name="all" depends="prepare">
		
		<concat destfile="${build}/login.js" fixlastline="yes">
			<filelist dir=".">
				<file name="lib/jquery.min.js"/>
                <file name="lib/jquery-ui-1.8.14.custom.min.js"/>
				<file name="lib/require.js"/>
                <file name="lib/jquery.plugins.js"/>
				<file name="src/tk/grid.js"/>
				<file name="src/tk/selection.js"/>
				<file name="src/login.js"/>
			</filelist>
		</concat>
		
		<copy overwrite="true" todir="${build}">
			<fileset dir="." includes="index.html"/>
			<fileset dir="." includes=".htaccess"/>
		</copy>
		
		<!-- copy dirs -->
		<copy overwrite="true" todir="${build}/src">
		    <fileset dir="src" includes="**"/>
		</copy>
		<copy overwrite="true" todir="${build}/apps">
            <fileset dir="apps" includes="**"/>
        </copy>
        <copy overwrite="true" todir="${build}/apps">
            <fileset dir="lib" includes="css.js"/>
        </copy>
		
		<!-- Replace version token -->
		<replace file="${build}/index.html">
			<replacefilter token="@ version @" value="${version}"/>
		</replace>
			
	</target>
		
</project>
