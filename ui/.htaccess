# Compress static data
AddOutputFilterByType DEFLATE text/html text/plain text/javascript application/javascript text/css text/xml application/xml text/x-js application/x-javascript

# Define pre-compressed files
AddType text/javascript .jsz
AddType text/css .cssz
AddType text/xml .xmlz
AddEncoding gzip .jsz .cssz .xmlz
SetEnvIf Request_URI "\.(jsz|cssz|xmlz)$" no-gzip

ExpiresActive On
# Set expire headers
ExpiresByType image/ico "access plus 6 months"
ExpiresByType image/gif "access plus 6 months"
ExpiresByType image/png "access plus 6 months"
ExpiresByType image/jpg "access plus 6 months"
ExpiresByType image/jpeg "access plus 6 months"
ExpiresByType text/css "access plus 6 months"
ExpiresByType text/html "access plus 6 months"
ExpiresByType text/xml "access plus 6 months"
ExpiresByType text/javascript "access plus 6 months"
ExpiresByType application/x-javascript "access plus 6 months"
ExpiresDefault "access plus 6 months"

# cache buster
# Modify headersâ€š
Header append Cache-Control "private"
Header unset Last-Modified
Header unset Vary
# Turn off ETag
Header unset ETag
FileETag None

# do never ever cache "index.html" or "offline.html"
<FilesMatch "^(index)\.html">
  ExpiresByType text/html "now"
  ExpiresDefault "now"
  Header set Cache-Control "no-store, no-cache, must-revalidate, post-check=0, pre-check=0"
</FilesMatch>

RewriteEngine On
# Strip version from requests
RewriteRule v=[^\/]+/(.+) $1 [L]
