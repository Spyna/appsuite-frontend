/**
 * All content on this website (including text, images, source
 * code and any other original works), unless otherwise noted,
 * is licensed under a Creative Commons License.
 *
 * http://creativecommons.org/licenses/by-nc-sa/2.5/
 *
 * Copyright (C) Open-Xchange Inc., 2006-2012
 * Mail: info@open-xchange.com
 *
 * @author Daniel Rentz <daniel.rentz@open-xchange.com>
 */

.btn-toolbar.io-ox-toolbar {

    /* generic mixin classes =============================================== */

    .box-sizing(@sizing-mode) {
        -webkit-box-sizing: @sizing-mode;
        -moz-box-sizing: @sizing-mode;
        box-sizing: @sizing-mode;
    }

    .border-radius(@radius) {
        -webkit-border-radius: @radius;
        -moz-border-radius: @radius;
        border-radius: @radius;
    }

    .border-top-left-radius(@radius) {
        -webkit-border-top-left-radius: @radius;
        -moz-border-radius-topleft: @radius;
        border-top-left-radius: @radius;
    }

    .border-top-right-radius(@radius) {
        -webkit-border-top-right-radius: @radius;
        -moz-border-radius-topright: @radius;
        border-top-right-radius: @radius;
    }

    .border-bottom-left-radius(@radius) {
        -webkit-border-bottom-left-radius: @radius;
        -moz-border-radius-bottomleft: @radius;
        border-bottom-left-radius: @radius;
    }

    .border-bottom-right-radius(@radius) {
        -webkit-border-bottom-right-radius: @radius;
        -moz-border-radius-bottomright: @radius;
        border-bottom-right-radius: @radius;
    }

    .box-shadow(@shadow) {
        -webkit-box-shadow: @shadow;
        -moz-box-shadow: @shadow;
        box-shadow: @shadow;
    }

    .box-shadow(@outset-shadow, @inset-shadow) {
        -webkit-box-shadow: @outset-shadow, inset @inset-shadow;
        -moz-box-shadow: @outset-shadow, inset @inset-shadow;
        box-shadow: @outset-shadow, inset @inset-shadow;
    }

    .opacity(@opacity) {
        @opacity-percent: @opacity * 100;
        opacity: @opacity;
        filter: alpha(opacity=@opacity-percent);
    }

    /* tool bar formatting ================================================= */

    /* tool bar background color */
    @background-color: #f5f5f5;

    /* tool bar border color */
    @border-color: #d5d5d5;

    /* --------------------------------------------------------------------- */

    /* redefine margin, padding, formatting for usage in OX */
    margin: 0;
    padding: 6px 13px 2px 13px;
    background-color: @background-color;
    border-bottom: 1px solid @border-color;

    /* prevent multi-line layout of button groups */
    white-space: nowrap;

    /* icons =============================================================== */

    /*
     * Replace images for icon classes starting with "icon-io-ox-".
     */
    i[class^="icon-io-ox-"] {
        background-image: url(img/ox-icons-black.png);
        &.icon-white { background-image: url(img/ox-icons-white.png); }
    }

    /*
     * Define class names for all icons.
     */
    i.icon-io-ox-undo           { background-position:      0    0; }
    i.icon-io-ox-redo           { background-position:  -24px    0; }
    i.icon-io-ox-bold           { background-position:  -48px    0; }
    i.icon-io-ox-bold.de-de     { background-position:  -72px    0; }
    i.icon-io-ox-italic         { background-position:  -96px    0; }
    i.icon-io-ox-italic.de-de   { background-position: -120px    0; }
    i.icon-io-ox-underline      { background-position: -144px    0; }

    /* buttons ============================================================= */

    /*
     * Adjust the default formatting of buttons defined by Bootstrap.
     */
    .btn {

        /* background color for selected toggle buttons */
        @selected-color: #d5d5ff;

        /* spacing between elements in a button */
        @whitespace-width: 5px;

        /* mixin that adds a border and inset shadow in the same color to a box */
        .accented-border(@color) {
            border: 1px solid @color;
            .box-shadow(inset 0 0 4px @color);
        }

        /* ----------------------------------------------------------------- */

        /* adjust button size */
        padding: 3px 6px;
        /* remove Bootstrap gradients, set solid color */
        background: none;
        background-color: @background-color;
        /* reserve space for border, needed for focus display */
        border: 1px solid transparent;
        .border-radius(0);
        .box-shadow(none);
        text-shadow: none;

        /* mouse and keyboard effects -------------------------------------- */

        /* mouse hover effect (not for disabled nor focused buttons) */
        &:hover:not(:disabled):not(.disabled):not(:focus) {
            z-index: 1;
            border-color: @border-color;
        }

        /* add focus highlighting (but not for active buttons) */
        &:focus:not(:active) {
            z-index: 2;
            .accented-border(@border-color);
        }

        /* active effect (button currently clicked) */
        &:active {
            z-index: 3;
            .accented-border(darken(@border-color, 5%));
            /* remove Bootstrap's gray text color */
            color: black;
        }

        /* prevent dotted focus rectangle around buttons */
        &:focus, &:active {
            outline: none;
        }

        /* selected toggle buttons ----------------------------------------- */

        &.selected {
            z-index: 5;
            background-color: @selected-color;
            border-color: darken(@selected-color, 5%);

            /* mouse hover effect (not for disabled nor focused buttons) */
            &:hover:not(:disabled):not(.disabled):not(:focus) {
                z-index: 6;
                border-color: darken(@selected-color, 10%);
            }

            /* add focus highlighting (but not for active buttons) */
            &:focus:not(:active) {
                z-index: 7;
                .accented-border(darken(@selected-color, 10%));
            }

            /* active effect (button currently clicked) */
            &:active {
                z-index: 8;
                .accented-border(darken(@selected-color, 15%));
            }
        }

        /* disabled buttons ------------------------------------------------ */

        &:disabled, &.disabled {
            .opacity(0.5);
        }

        /* class for whitespace between icons, text, and dropdown arrows */
        > span.whitespace {
            display: inline-block;
            width: @whitespace-width;
        }

        /* move drop-down arrow down to the center of the button */
        > span.caret {
            margin-top: 6px;
        }

        /* remove hover highlight of drop-down arrow for disabled buttons */
        &:disabled, &.disabled {
            > span.caret {
                .opacity(.3);
            }
        }
    }

    /* button groups ======================================================= */

    .btn-group {

        /* The class 'io-ox-hidden' is used to hide button groups. */
        &.io-ox-hidden {
            display: none;
        }
    }

    /* drop-down menus ===================================================== */

    .btn-group > .dropdown-menu {

        border: 1px solid @border-color;
        .border-radius(0);

        /* table-style button drop-downs ----------------------------------- */

        &.io-ox-button-grid {

            padding: 0;
            border-collapse: collapse;

            td {
                padding: 0;

                /* all buttons: adjust for table view */
                > .btn {
                    width: 100%;
                }
            }
        }

        /* size chooser drop-downs ----------------------------------------- */

        &.io-ox-size-chooser {

            /* inner size of one cell in the size chooser */
            @cell-size: 18px;

            /* reset Bootstrap's formatting */
            padding: 0;
            min-width: 0;
            max-width: none;

            > .btn {
                padding: 0;
                border: none;

                /* grid layout (done with embedded divs instead of a table to prevent grid flicker */
                > div {

                    /* a row in the grid */
                    > div {
                        /* need to set height explicitly for Firefox */
                        height: @cell-size + 1;
                        /* font size may affect box sizing, shrink it */
                        font-size: 1px;
                        line-height: 100%;

                        /* a cell in the grid */
                        > div {
                            display: inline-block;
                            width: @cell-size;
                            height: @cell-size;
                            border-bottom: 1px solid @border-color;

                            &:not(:last-child) {
                                border-right: 1px solid @border-color;
                            }
                        }

                        &:not(:last-child) > div {
                            border-bottom: 1px solid @border-color;
                        }

                        /* height for last row (again, especially for Firefox) */
                        &:last-child {
                            height: @cell-size;
                        }
                    }
                }

                /* the badge labels showing the width and height of the grid */
                > span {
                    position: absolute;
                    margin: 0;
                    padding: 2px 4px;
                    background-color: #888;
                    .opacity(0.75);
                    .border-radius(8px);
                    .box-shadow(2px 2px 3px #ccc);
                    font-size: 10px;
                    line-height: 100%;
                    color: white;
                    text-shadow: none;
                    z-index: 10;

                    &.width-label {
                        top: 2px;
                        right: 4px;
                    }

                    &.height-label {
                        bottom: 2px;
                        left: 4px;
                    }
                }
            }
        }
    }
    
    /* adjust margins for caret buttons in split mode */
    .btn-group > .btn.io-ox-caret-button {
        padding-left: 4px;
        padding-right: 4px;
    }
    
    /* set border to drop-down buttons with visible drop-down menu */
    .btn-group.open > .btn:not(:focus):not(:active) {
        border-color: @border-color;
    }
}
