/**
 * All content on this website (including text, images, source
 * code and any other original works), unless otherwise noted,
 * is licensed under a Creative Commons License.
 *
 * http://creativecommons.org/licenses/by-nc-sa/2.5/
 *
 * Copyright (C) Open-Xchange Inc., 2006-2012
 * Mail: info@open-xchange.com
 *
 * @author Daniel Rentz <daniel.rentz@open-xchange.com>
 */

/* generic mix-in classes ================================================== */

.opacity(@opacity) {
    @opacity-percent: @opacity * 100;
    opacity: @opacity;
    filter: alpha(opacity=@opacity-percent);
}

.debug-highlight-mixin(@color) {
    outline: 1px @color solid;
    background-color: fade(lighten(@color, 10%), 50%) !important;
}

/* editor GUI elements ===================================================== */

.io-ox-office-title {
    margin-left: 5px;
    margin-right: 5px;
    padding-left: 5px;
    padding-right: 5px;
    border: 1px solid transparent;
    cursor: pointer;

    &:hover {
        border-color: #d5d5d5;
        .border-radius(4px);
    }
}

/* editor application ====================================================== */

.io-ox-office-editor-main {

    /* the label displaying the current status of the editor application */
    .view-component .group.status-label label {
        margin: 6px;
        height: 20px;
        line-height: 20px;
        background: white;
        .border-radius(10px);
        .box-shadow(0 4px 8px fade(black, 25%));
        color: #666666;
        font-size: 11px;
        font-weight: bold;

        &[data-state="nofile"], &[data-state="offline"] {
            background: #eaa;
            color: #755;
        }

        &[data-state="readonly"], &[data-state="sending"] {
            background: #eea;
            color: #775;
        }

        &[data-state="initial"], &[data-state="ready"] {
            background: #aea;
            color: #575;
        }
    }

    .page {
        /* default page formatting */
        .box-sizing(border-box);
        width: 210mm;
        min-height: 297mm;
        padding: 15mm;

        /* text cursor over entire page, but not in read-only mode */
        &.io-ox-office-edit-mode {
            cursor: text;

	        /* resize cursor for table cells, but not in read-only mode */
	        table td > div.cell {
		        > div.bottomborder {
		           	cursor: row-resize;
		        }
				> div.rightborder {
					cursor: col-resize;
				}
	        }
        }

        /* default paragraph formatting */
        div.p {
            position: relative;
            margin: 0;
            line-height: 0;
            word-wrap: break-word;

            > div.field, > div.list-label {
                display: inline-block;
            }

            /* needs white-space: nowrap to have correct width */
            > div.tab {
                display: inline-block;
                white-space: nowrap;
            }

            /* default text formatting (also for fields and list labels) */
            > span, > div > span {
                font-family: sans-serif;
                font-size: 11pt;
                line-height: normal;

                /* highlighted portions (quick search) */
                &.highlight {
                    .opacity(1);
                    background-color: yellow !important;
                    color: black !important;
                }
            }

            &:after {
                content: '.';
                display: block;
                height: 0;
                clear: both;
                visibility: hidden;
            }
        }

        /* no text cursor in read-only mode */
        &:not(.user-select-text) div.p {
            cursor: default;
        }

        /* default table formatting */
        table {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
            margin: 6px 0;

            &:first-child { margin-top: 0; }
            &:last-child { margin-bottom: 0; }

            tr {
                height: 100%;
            }

            td {
                padding: 4px;
                vertical-align: top;
                height: 100%;

                > div.cell {
                    position: relative;
                    width: 100%;
                    height: 100%;
                    border: hidden;

                    > div.cellcontent {
                    }

                    > div.bottomborder {
                        position: absolute;
                        border: 0px;
                        height: 4px;
                        bottom: -6px;   /* dependent from <td> padding and height */
                        left: -4px;   /* dependent from <td> padding */
                        right: -5px;   /* dependent from <td> padding */
                    }

                    > div.rightborder {
                        position: absolute;
                        border: 0px;
                        width: 4px;
                        right: -6px;   /* dependent from <td> padding and width */
                        top: -4px;   /* dependent from <td> padding */
                        bottom: -5px;   /* dependent from <td> padding */
                    }
                }
            }
        }

        /* drawings */
        div.drawing {
            position: relative;
            cursor: default;
            font-size: 0;

            /* inlined drawings */
            &.inline {
                display: inline-block;
                vertical-align: bottom;
            }

            /* crop drawing contents at drawings border */
            > div.content {
                position: absolute;
                width: 100%;
                height: 100%;
                overflow: hidden;

                img {
                    position: relative;
                    /* remove max-width:100% derived from Bootstrap */
                    max-width: none;
                }
            }

            /* selection box for drawings/images */
            > div.selection {
                @border-color: #3f7fff;

                position: absolute;
                top: -1px;
                bottom: -1px;
                left: -1px;
                right: -1px;
                border: 3px fade(@border-color, 70%) solid;
                .box-shadow(0 5px 10px fade(black, 20%));
                cursor: default;

                > div.handle {
                    position: absolute;
                    width: 5px;
                    height: 5px;
                    background-color: white;
                    border: 1px @border-color solid;
                    .border-radius(3px);

                    .v-beg() { top: -5px; }
                    .v-cen() { top: 50%; margin-top: -3px; }
                    .v-end() { bottom: -5px; }

                    .h-beg() { left: -5px; }
                    .h-cen() { left: 50%; margin-left: -3px; }
                    .h-end() { right: -5px; }

                    &.tl { .v-beg(); .h-beg(); cursor: nw-resize; }
                    &.t  { .v-beg(); .h-cen(); cursor: n-resize;  }
                    &.tr { .v-beg(); .h-end(); cursor: ne-resize; }
                    &.r  { .v-cen(); .h-end(); cursor: e-resize;  }
                    &.br { .v-end(); .h-end(); cursor: se-resize; }
                    &.b  { .v-end(); .h-cen(); cursor: s-resize;  }
                    &.bl { .v-end(); .h-beg(); cursor: sw-resize; }
                    &.l  { .v-cen(); .h-beg(); cursor: w-resize;  }
                }

                &:not(.sizeable) > div.handle {
                    cursor: inherit;
                }
            }

            /* move and resize box for drawings/images */
            > div.move {
                position: absolute;
                top: 2px;
                bottom: 2px;
                left: 2px;
                right: 2px;
                border: 0px dotted black;
                cursor: move;

                &:not(.moveable) {
                    cursor: inherit;
                }
            }
        }

        /* floated elements (drawings and offset helper divs) */
        div.float {
            display: block;

            &.left { float: left; clear: left; }
            &.right { float: right; clear: right; }
        }

        /* prevent dotted focus rectangle around page area */
        &:focus, &:active {
            outline: none;
        }

        /* fade out remaining document while highlighting quick-search matches */
        &.highlight > * {
            .opacity(0.7);
        }

        /* debug highlighting for document contents */
        &.debug-highlight {

            /* paragraph nodes */
            div.p {
                .debug-highlight-mixin(#8f8);

                /* text portions in paragraph */
                > span {
                    .debug-highlight-mixin(#88f);
                }

                /* special text components in paragraph counting as one character */
                > div.component {
                    .debug-highlight-mixin(#f8f);
                }

                /* helper nodes in paragraph */
                > div.list-label {
                    .debug-highlight-mixin(#f88);
                }
            }

            /* other document content nodes */
            table, div.drawing {
                .debug-highlight-mixin(#f88);
                outline-offset: 1px;
            }
        }
    }

    div.resizeline {
        position: absolute;
        border: 1px dotted black;
    }

    div.hyperlink-popup {
        font-family: sans-serif;
        font-size: 13px;
        line-height: normal;
	    position: absolute;
        border: 1px solid;
        .box-shadow(0 5px 10px fade(black, 25%));
        border-color: #B0B0B0;
        padding: 10px 20px;
        background-color: white;

        a.textwrap {
            word-wrap: break-word;
        }

        span.link {
            color: #08C;

           &:hover {
               color: #005580;
               text-decoration:underline;
               cursor: pointer;
           }
        }
    }

    .view-pane.debug > table {
        width: 100%;
        table-layout: fixed;
        border-collapse: separate;
        border-spacing: 1px;
        background-color: white;

        td {
            padding: 0;
            border: 1px #d5d5d5 solid;

            > div {
                height: 5cm;
                overflow: auto;

                > table {
                    width: 100%;
                    table-layout: auto;
                    border-collapse: collapse;
                    font-family: 'Open Sans',Arial,sans-serif;
                    font-size: 8pt;
                    line-height: normal;
                    white-space: nowrap;

                    th, td {
                        padding: 0 1mm;
                    }

                    th {
                        background-color: #d5d5d5;
                        color: #666;
                        font-weight: bold;
                    }

                    td:first-child {
                        background-color: #d5d5d5;
                        color: white;
                        font-weight: bold;
                        text-align: right;
                    }
                }
            }
        }
    }
}

/* clipboard =============================================================== */

.io-ox-office-clipboard {
    position: absolute;
    top: -10000px;
    left: -10000px;
}
