/**
 * All content on this website (including text, images, source
 * code and any other original works), unless otherwise noted,
 * is licensed under a Creative Commons License.
 *
 * http://creativecommons.org/licenses/by-nc-sa/2.5/
 *
 * Copyright (C) Open-Xchange Inc., 2006-2012
 * Mail: info@open-xchange.com
 *
 * @author Daniel Rentz <daniel.rentz@open-xchange.com>
 */

/* ========================================================================= */
/* generic mixin classes                                                     */
/* ========================================================================= */

.box-sizing(@sizing-mode) {
    -webkit-box-sizing: @sizing-mode;
    -moz-box-sizing: @sizing-mode;
    box-sizing: @sizing-mode;
}

.border-radius(@radius) {
    -webkit-border-radius: @radius;
    -moz-border-radius: @radius;
    border-radius: @radius;
}

.border-top-left-radius(@radius) {
    -webkit-border-top-left-radius: @radius;
    -moz-border-radius-topleft: @radius;
    border-top-left-radius: @radius;
}

.border-top-right-radius(@radius) {
    -webkit-border-top-right-radius: @radius;
    -moz-border-radius-topright: @radius;
    border-top-right-radius: @radius;
}

.border-bottom-left-radius(@radius) {
    -webkit-border-bottom-left-radius: @radius;
    -moz-border-radius-bottomleft: @radius;
    border-bottom-left-radius: @radius;
}

.border-bottom-right-radius(@radius) {
    -webkit-border-bottom-right-radius: @radius;
    -moz-border-radius-bottomright: @radius;
    border-bottom-right-radius: @radius;
}

.box-shadow(@shadow) {
    -webkit-box-shadow: @shadow;
    -moz-box-shadow: @shadow;
    box-shadow: @shadow;
}

.box-shadow(@outset-shadow, @inset-shadow) {
    -webkit-box-shadow: @outset-shadow, inset @inset-shadow;
    -moz-box-shadow: @outset-shadow, inset @inset-shadow;
    box-shadow: @outset-shadow, inset @inset-shadow;
}

.impl-linear-gradient(@start-point, @start-color, @end-color, @ie-gradient-type) {
    background-color: mix(@start-color, @end-color, 50%);
    background: -webkit-linear-gradient(@start-point, @start-color, @end-color);
    background: -moz-linear-gradient(@start-point, @start-color, @end-color);
    background: -ms-linear-gradient(@start-point, @start-color, @end-color);
    background: -o-linear-gradient(@start-point, @start-color, @end-color);
    background: linear-gradient(@start-point, @start-color, @end-color);
    filter: e(%("progid:DXImageTransform.Microsoft.gradient(startColorstr='%d', endColorstr='%d', GradientType=%d)",@start-color,@end-color,@ie-gradient-type));
}

.horizontal-gradient(@left-color, @right-color) {
    .impl-linear-gradient(left, @left-color, @right-color, 1);
}

.vertical-gradient(@top-color, @bottom-color) {
    .impl-linear-gradient(top, @top-color, @bottom-color, 0);
}

.opacity(@opacity) {
    @opacity-percent: @opacity * 100;
    opacity: @opacity;
    filter: alpha(opacity=@opacity-percent);
}

/* ========================================================================= */
/* OX icons                                                                  */
/* ========================================================================= */

/*
 * Replace images for icon classes starting with "icon-io-ox-". Icons are
 * 14x14px with a 6px grid spacing.
 */
i[class^="icon-io-ox-"] {
    background-image: url(img/ox-icons-black.png);
    width: 14px;
    height: 14px;
    
    &.icon-white {
        background-image: url(img/ox-icons-white.png);
    }
}

/* special icon for the drop-down caret */
i.icon-io-ox-caret {
    background-position: 0 0;
    width: 7px;
    
    &.up {
        background-position: -7px 0;
    }
}
   
/*
 * Define class names for all icons.
 */
i.icon-io-ox-undo           { background-position:  -20px    0; }
i.icon-io-ox-redo           { background-position:  -40px    0; }
i.icon-io-ox-bold           { background-position:  -60px    0; }
i.icon-io-ox-bold.de_DE     { background-position:  -80px    0; }
i.icon-io-ox-italic         { background-position: -100px    0; }
i.icon-io-ox-italic.de_DE   { background-position: -120px    0; }
i.icon-io-ox-underline      { background-position: -140px    0; }
i.icon-io-ox-table          { background-position: -160px    0; }

/* ========================================================================= */
/* panes and tool bars                                                       */
/* ========================================================================= */

/* background color for panes */
@pane-fill-color: #f5f5f5;

/* border color for panes */
@pane-border-color: #d5d5d5;

/* border color for selected controls */
@selected-border-color: #b5b5ff;

/* fill color for selected controls */
@selected-fill-color: #d5d5ff;

/* mixin that adds a border and inset shadow in the same color to a box */
.accented-border(@color) {
    border: 1px solid @color;
    .box-shadow(inset 0 0 4px @color);
}

/* tool panes ============================================================== */

div.io-ox-toolpane {
    background-color: @pane-fill-color;

    &.top { border-bottom: 1px solid @pane-border-color; }
    &.bottom { border-top: 1px solid @pane-border-color; }
    &.left { border-right: 1px solid @pane-border-color; }
    &.right { border-left: 1px solid @pane-border-color; }
}

/* tool bars =============================================================== */

div.io-ox-toolbar {
    padding: 4px 13px;
    /* prevent multi-line layout of button groups */
    white-space: nowrap;
    text-align: center;

    > span {
        display: inline-block;
    }

    /* common controls ----------------------------------------------------- */

    label, button {
        display: inline;
        position: relative;
        margin: 0;
        padding: 4px 8px;
        background: none;
        border: 1px solid transparent;
        white-space: nowrap;
        text-align: center;
        vertical-align: middle;
        text-shadow: none;
    
        &.disabled {
            .opacity(0.5);
        }
    
        /* prevent dotted focus rectangle around the control */
        &:focus, &:active {
            outline: none;
        }
    
        /* whitespace between icons, text, and drop-down carets */
        > span.whitespace {
            display: inline-block;
            width: 5px;
        }
    }

    /* buttons ------------------------------------------------------------- */

    button {

        /* mouse and keyboard effects */
        &:not(.disabled) {

            /* mouse hover effect (not for disabled nor focused buttons) */
            &:hover:not(:focus) {
                z-index: 1;
                border-color: @pane-border-color;
            }

            /* add focus highlighting (but not for active buttons) */
            &:focus:not(:active) {
                z-index: 2;
                .accented-border(@pane-border-color);
            }

            /* active effect (button currently clicked) */
            &:active {
                z-index: 3;
                .accented-border(darken(@pane-border-color, 5%));
                /* remove Bootstrap's gray text color */
                color: black;
            }
        }

        /* selected toggle buttons */
        &.selected {
            z-index: 20;
            background-color: @selected-fill-color;
            border-color: @selected-border-color;

            &:not(.disabled) {

                /* mouse hover effect (not for disabled nor focused buttons) */
                &:hover:not(:focus) {
                    z-index: 21;
                    border-color: darken(@selected-border-color, 5%);
                }

                /* add focus highlighting (but not for active buttons) */
                &:focus:not(:active) {
                    z-index: 22;
                    .accented-border(darken(@selected-border-color, 5%));
                }

                /* active effect (button currently clicked) */
                &:active {
                    z-index: 23;
                    .accented-border(darken(@selected-border-color, 10%));
                }
            }
        }
    }

    /* groups -------------------------------------------------------------- */

    .group {
        display: inline-block;
        /* relative position is essential for drop-down menu positioning */
        position: relative;

        /* class 'hidden' is used to hide the entire group */
        &.hidden {
            display: none;
        }

        /* space between groups */
        + .group {
            margin-left: 10px;
        }

        > button + button {
            margin-left: -1px;
        }

        /* adjust margins for caret buttons in drop-down split mode */
        > button.caret-button {
            padding-left: 4px;
            padding-right: 4px;
        }

        /* set border to all buttons in drop-down group with visible menu */
        &.menu-open > button:not(:focus):not(:active) {
            border-color: @pane-border-color;
        }
    }

    /* drop-down menus ----------------------------------------------------- */

    .group > .dropdown-menu {
        display: none;
        position: absolute;
        top: 100%;
        left: 0;
        min-width: 0;
        max-width: none;
        z-index: 1000;
        margin: 1px 0 0 0;
        padding: 0;
        border: 1px solid @pane-border-color;
        .border-radius(0);

        /* button chooser control */

        &.button-chooser > table {
            margin: -1px;
            border-collapse: collapse;
            max-width: none;

            td { padding: 0; }
        }

        /* size chooser control */

        &.size-chooser {

            /* inner size of one cell in the size chooser */
            @cell-size: 18px;

            /* minimum dimensions for the outer container (in cells) */
            min-width: 5 * (@cell-size + 1px) - 1px;
            min-height: 3 * (@cell-size + 1px) - 1px;
            text-align: left;

            > button {
                margin: -1px;
                padding: 0;
                .accented-border(@pane-border-color);
                vertical-align: top;
                font-size: 1px;
                line-height: normal;

                /* grid layout (done with embedded divs instead of a table to prevent grid flicker */
                > div {

                    /* a row in the grid */
                    > div {
                        /* need to set height explicitly for Firefox */
                        height: @cell-size + 1px;

                        /* a cell in the grid */
                        > div {
                            display: inline-block;
                            width: @cell-size;
                            height: @cell-size;
                            border-bottom: 1px solid @pane-border-color;

                            &:not(:last-child) {
                                border-right: 1px solid @pane-border-color;
                            }
                        }

                        &:not(:last-child) > div {
                            border-bottom: 1px solid @pane-border-color;
                        }

                        /* height for last row (again, especially for Firefox) */
                        &:last-child {
                            height: @cell-size;
                        }
                    }
                }

                /* the badge labels showing the width and height of the grid */
                > span {
                    position: absolute;
                    top: 100%;
                    right: @cell-size;
                    z-index: 1020;
                    margin: 5px 0 0 0;
                    padding: 4px 6px;
                    background-color: black;
                    .opacity(0.8);
                    .border-radius(9px);
                    .box-shadow(0 4px 8px rgba(0, 0, 0, 0.2));
                    font-size: 11px;
                    line-height: 100%;
                    color: white;
                    text-shadow: none;
                }
            }
        }
    }

    .group.menu-open > .dropdown-menu {
        display: block;
    }
}

/* tab bars ================================================================ */

div.io-ox-toolbar.tabs {
    padding-bottom: 0;

    > span {
        margin-bottom: -1px;
    }

    > div.separator {
        text-align: center;
        font-size: 1px;
        line-height: 0;

        > span {
            display: inline-block;
            position: relative;
            width: 40%;
            height: 1px;
            /* override the button borders */
            z-index: 100;

            @border-color: @pane-border-color;
            &.left { .horizontal-gradient(fade(@border-color, 0%), @border-color); }
            &.right { .horizontal-gradient(@border-color, fade(@border-color, 0%)); }
        }
    }
}
