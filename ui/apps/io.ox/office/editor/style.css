/**
 * All content on this website (including text, images, source
 * code and any other original works), unless otherwise noted,
 * is licensed under a Creative Commons License.
 *
 * http://creativecommons.org/licenses/by-nc-sa/2.5/
 *
 * Copyright (C) Open-Xchange Inc., 2006-2012
 * Mail: info@open-xchange.com
 *
 * @author Daniel Rentz <daniel.rentz@open-xchange.com>
 */

.box-sizing(@sizing-mode) {
    -webkit-box-sizing: @sizing-mode;
    -moz-box-sizing: @sizing-mode;
    box-sizing: @sizing-mode;
}

.border-radius(@radius) {
    -webkit-border-radius: @radius;
    -moz-border-radius: @radius;
    border-radius: @radius;
}

.opacity(@opacity) {
    @opacity-percent: @opacity * 100;
    opacity: @opacity;
    filter: alpha(opacity=@opacity-percent);
}

.debug-highlight-mixin(@color) {
    outline: 1px @color solid;
    background-color: fade(@color, 20%);
}

.io-ox-office-title {
    margin-left: 5px;
    margin-right: 5px;
    padding-left: 5px;
    padding-right: 5px;
    border: 1px solid transparent;
    cursor: pointer;
    
    &:hover {
        border-color: #d5d5d5;
        border-radius: 4px;
        -moz-border-radius: 4px;
    }
}

.io-ox-office-main {
    margin: 0;
    padding: 0;

    .io-ox-office-apppane {
    	margin: 0;
    	padding: 0;
    	background-color: #e5e5e5;
    	overflow-y: auto;
    }
    
    .io-ox-pane.debug > table.debug-table {
        width: 100%;
        table-layout: fixed;
        background-color: white;
    }

    .io-ox-office-editor {
        .box-sizing(border-box);
        cursor: text;
        background-color: white;
        position: relative;

        p {
            margin: 0;
            font-size: 12pt;
            line-height: 0;
            position: relative;
        }

        table {
            table-layout: fixed;
            width: 100%;
            border-collapse: collapse;
            margin: 6px 0;

            &:first-child { margin-top: 0; }
            &:last-child { margin-bottom: 0; }

            th, td {
                padding: 4px;
                border: 1px solid black;
                vertical-align: top;
            }
        }

        div.selection {
            @border-color: #44f;
    
            .box-sizing(border-box);
            position: absolute;
            border: 3px fade(@border-color, 70%) solid;

            cursor: default;
            &.moveable { cursor: move; }
    
            > div.handler {
                position: absolute;
                width: 5px;
                height: 5px;
                background-color: white;
                border: 1px @border-color solid;
                .border-radius(3px);
    
                .v-beg() { top: -5px; }
                .v-cen() { top: 50%; margin-top: -3px; }
                .v-end() { bottom: -5px; }
    
                .h-beg() { left: -5px; }
                .h-cen() { left: 50%; margin-left: -3px; }
                .h-end() { right: -5px; }
    
                &.tl { .v-beg(); .h-beg(); cursor: nw-resize; }
                &.t  { .v-beg(); .h-cen(); cursor: n-resize;  }
                &.tr { .v-beg(); .h-end(); cursor: ne-resize; }
                &.r  { .v-cen(); .h-end(); cursor: e-resize;  }
                &.br { .v-end(); .h-end(); cursor: se-resize; }
                &.b  { .v-end(); .h-cen(); cursor: s-resize;  }
                &.bl { .v-end(); .h-beg(); cursor: sw-resize; }
                &.l  { .v-cen(); .h-beg(); cursor: w-resize;  }
            }
            
            &:not(.sizeable) > div.handler {
                cursor: inherit;
            }
        }
    
        /* prevent dotted focus rectangle around page area */
        &:focus, &:active {
            outline: none;
        }

        &.highlight > * {
            .opacity(0.7);
        }

        &.rich {
            width: 210mm;
            padding: 15mm;
            margin: 30px auto;
            border: 1px solid gray;

            p > span {
                font-family: sans-serif;
                font-size: 11pt;
                line-height: normal;

                &.highlight {
                    .opacity(1);
                    background-color: yellow !important;
	                color: black !important;
	            }
            }
        }

        &.plain {
            width: 100%;
            height: 5cm;
            padding: 6px;
            overflow-y: auto;
            border: 1px #d5d5d5 solid;

            p > span {
                font-family: 'Courier New',Courier,monospace;
                font-size: 10pt;
                line-height: normal;
            }
        }

        &.output {
            width: 100%;
            height: 5cm;
            overflow-y: auto;
            border: 1px #d5d5d5 solid;

            > table {
                table-layout: auto;
                border-collapse: collapse;
                font-family: Arial,sans-serif;
                font-size: 8pt;
                line-height: normal;
                white-space: nowrap;

                td {
                    padding: 0 1mm;
                    border: 1px #d5d5d5 solid;

                    &:first-child {
                        background-color: #d5d5d5;
                        color: white;
                        text-align: right;
                    }
                }
            }
        }

        &.rich.debug-highlight {

            p {
                .debug-highlight-mixin(#8f8);
            }

            span {
                .debug-highlight-mixin(#88f);
            }

            img, table {
                .debug-highlight-mixin(#f88);
                outline-offset: 2px;
            }

            p > div {
                .debug-highlight-mixin(#f8f);
            }
        }
    }
}
